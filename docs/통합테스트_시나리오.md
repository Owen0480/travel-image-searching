# 통합 테스트 시나리오 (PPT용)

---

## 사전 조건
- **Frontend**: `npm run dev` (5173)
- **Spring Boot**: 실행 (8081)
- **FastAPI**: `uvicorn app.main:app --reload` (8000)
- **MariaDB / Redis**: 실행 중
- **Gemini API Key**: `.env` 설정 (선택, 미설정 시 가이드 실패 시 한글 메시지 표시)

---

## 시나리오 1: 로그인 → 메인 진입
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 1-1 | 브라우저에서 `/login` 접속 | 로그인 화면 표시 |
| 1-2 | Google OAuth 로그인 클릭 | Google 인증 페이지 이동 |
| 1-3 | Google 계정 선택 후 승인 | `/auth/callback` → JWT 발급 → `/chat` 리다이렉트 |
| 1-4 | 상단 메뉴 확인 | Discover / Chat / My Trips 등 표시 |

---

## 시나리오 2: 이미지 검색 (image-search) — 추천·가이드·상세보기
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 2-1 | `/image-search` 이동 | 업로드 영역 + 취향 입력란 표시 |
| 2-2 | 취향 입력 (예: 가족, 맛집) | 입력값 유지 |
| 2-3 | 사진 선택 후 "매칭 여행지 찾기" 클릭 | 로딩 오버레이 표시 |
| 2-4 | API 응답 대기 | Spring 8081 → FastAPI 8000 호출 |
| 2-5 | 성공 시 | 카드 3개 표시(장소명, 주소, 유사도%, 가이드 문장, 이미지) |
| 2-6 | 카드 "상세 보기" 클릭 | 네이버 지도 검색 새 창 오픈 |
| 2-7 | 유사 장소 없음(score≤0.6) 시 | "유사한 여행지를 찾지 못했습니다" + AI 설명 또는 실패 사유 메시지 |
| 2-8 | Gemini 실패(할당량 등) 시 | 한글 실패 사유 표시(할당량 초과 등) |

---

## 시나리오 3: 채팅 (travel-chat)
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 3-1 | `/chat` 이동 | Conversation UI(iframe) 표시 |
| 3-2 | 메시지 입력 후 전송 (예: "부산 맛집 추천해줘") | 사용자 말풍선 표시 |
| 3-3 | API 응답 대기 | Spring → FastAPI travel-chat 호출 |
| 3-4 | 성공 시 | AI 응답 말풍선 표시, thread_id 유지 |
| 3-5 | 대화 저장 버튼 클릭 (구현 시) | SavedConversation 저장 후 목록 반영 |

---

## 시나리오 4: 여행 스타일 분석 (travel-style)
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 4-1 | `/travel-style` 이동 | 관심사 옵션(키워드) 표시 |
| 4-2 | 관심사 3개 선택 (예: 맛집, 전시, 카페) | 선택 상태 유지 |
| 4-3 | "분석하기" 클릭 | 로딩 표시 |
| 4-4 | API 응답 대기 | Spring → FastAPI travel-style/analyze 호출 |
| 4-5 | 성공 시 | matched_type / reason / confidence 등 결과 표시(팝업 또는 영역) |
| 4-6 | 비로그인 시 | 결과만 표시, DB 저장 시 user_id null |

---

## 시나리오 5: 마이페이지
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 5-1 | 로그인 후 `/mypage` 이동 | 사용자 정보 등 표시 |
| 5-2 | (구현 시) 저장된 대화 목록 조회 | SavedConversation 목록 표시 |

---

## 시나리오 6: 비정상/예외
| 단계 | 조치 | 예상 결과 |
|------|------|-----------|
| 6-1 | Spring Boot 중지 후 이미지 검색 요청 | 연결 실패 메시지(500 또는 프론트 alert) |
| 6-2 | FastAPI 중지 후 이미지 검색 요청 | Spring 500 → 프론트에 실패 메시지 |
| 6-3 | 토큰 만료 후 API 호출 | 401 → Refresh 시도 → 실패 시 로그인 페이지 유도 |
| 6-4 | 이미지 검색 시 로그인 없이 요청 | `/recommend/**` permitAll 이므로 200 가능(설정에 따름) |

---

## PPT에 넣을 때 추천 슬라이드 구성
1. **통합 테스트 개요** — 사전 조건, 테스트 범위(로그인/이미지검색/채팅/여행스타일/마이페이지)
2. **시나리오 1** — 로그인 플로우 (표 또는 단계별 불릿)
3. **시나리오 2** — 이미지 검색 플로우 (핵심: 업로드 → API → Top3·가이드·상세보기)
4. **시나리오 3·4·5** — 채팅 / 여행스타일 / 마이페이지 (각 1슬라이드 요약)
5. **시나리오 6** — 예외 케이스 요약

위 표는 그대로 복사해 PPT 표로 붙여넣거나, 불릿으로 줄여서 사용하면 됩니다.
